<%= javascript_packs_with_chunks_tag "dashboardTagsDisableUnchangedButtons", defer: true %>

<div id="following-wrapper" class="grid gap-3 m:gap-4 s:grid-cols-2 l:grid-cols-3 px-3 m:px-0">
  <% tags.each do |follow| %>
    <% tag = follow.followable %>
    <% if tag %>
      <div class="crayons-card branded-2 p-4 m:p-6 m:pt-4 flex flex-col single-article break-word content-center" style="border-top-color: <%= tag.bg_color_hex %>;" id="follows-<%= follow.id %>">
        <h3 class="s:mb-1 -ml-1 p-0 fw-medium">
          <%= render_tag_link(tag.name) %>
        </h3>

        <p class="grid-cell__summary truncate-at-2 mb-4 fs-m h-50">
          <%= strip_tags(tag.short_summary) %>
        </p>

        <% if page === "following" %>
          <div class="flex justify-between">
            <div>
              <btn class="c-btn c-btn--secondary follow-button" data-follow-id="<%= follow.id %>" data-tag-id="<%= tag.id %>"><%= t("views.dashboard.tags.following_button") %></btn>
            </div>
            <div class="dropdown-trigger-container relative">
              <button type="button" class="c-btn c-btn--icon-alone dropdown-trigger" id="options-dropdown-trigger-<%= tag.id %>" aria-haspopup="true" aria-expanded="false" aria-controls="options-dropdown">
                <%= crayons_icon_tag("overflow-horizontal", title: t("views.dashboard.tags.options.icon")) %>
              </button>
              <div class="crayons-dropdown right-0 left-0 s:left-auto" id="options-dropdown-<%= tag.id %>">
                <ul class="p-0">
                  <li>
                    <button type="button" class="c-btn c-btn--icon-alone flex items-center">
                      <%= crayons_icon_tag("eye-off", width: 18, height: 18, title: t("views.dashboard.tags.options.hide")) %> <span class="ml-2"><%= t("views.dashboard.tags.options.hide") %></span>
                    </button>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        <% end %>

        <% if page === "hidden" %>
          <div>
            <btn class="crayons-btn crayons-btn--danger unhide-button" data-follow-id="<%= follow.id %>" data-tag-id="<%= tag.id %>"><%= t("views.dashboard.tags.unhide_button") %></btn>
          </div>
        <% end %>
      </div>
    <% end %>
  <% end %>
</div>
